# otel-python-demo
In this repo, you'll find a simple Python demo app instrumented with OpenTelemetry based on the Python [Getting Started](https://opentelemetry.io/docs/languages/python/getting-started/) guide.  This app provides a easy-to-use, lightweight way to familiarize yourself with running OpenTelemetry instrumented microservices running in a Kubernetes cluster.  

The OpenTelemetry Collector is configured to send telemetry data to your New Relic account where you can easily visualize Metrics, Traces, and Logs in a single, integrated platform.

## Installing the OpenTelemetry Collector

Install the OpenTelemetry Collector into your cluster using the [OpenTelemetry Collector Helm Chart](https://github.com/open-telemetry/opentelemetry-helm-charts/tree/main/charts/opentelemetry-collector).  The values.yaml file in this repo has been pre-configured to work with your New Relic account.

### Create a secret for your New Relic License Key

```
export NEW_RELIC_LICENSE_KEY=<YOUR NEW RELIC INGEST LICENSE KEY>
kubectl create secret generic nr-license-key --from-literal=license-key="$NEW_RELIC_LICENSE_KEY" -n collector
```

### Install the collector
```
helm repo add open-telemetry https://open-telemetry.github.io/opentelemetry-helm-charts
helm upgrade --install opentelemetry-collector open-telemetry/opentelemetry-collector -f collector/values.yaml -n collector --create-namespace
```

## Installing the demo app

The Python app in this repo replicates a simple roll of the dice while tracking the activity using Metrics, Logs, and Traces.  The telemetry generated by the app is sent to the OpenTelemery collecor where it goes through some minimal processing and then exported to the New Relic platform for visualization.

```
kubectl create ns demo && kubectl apply -f k8s/. -n demo
```

## Building the Container

```
docker buildx build --platform linux/amd64,linux/arm64 ./ -t <your user>/otel-python-demo:0.1
```

```
docker push <your user>/otel-python-demo:0.1
```